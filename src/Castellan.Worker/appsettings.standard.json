{
  // Standard Configuration Template for CastellanAI
  // Includes commonly customized settings: Authentication, AI, Notifications, and Threat Intelligence
  // For minimal configuration, see appsettings.minimal.json
  // For all advanced options, see appsettings.advanced.json

  "Authentication": {
    "Jwt": {
      "SecretKey": "", // REQUIRED: 64+ character secret (or set AUTHENTICATION__JWT__SECRETKEY env var)
      "Issuer": "castellan-security",
      "Audience": "castellan-admin",
      "ExpirationHours": 24
    },
    "AdminUser": {
      "Username": "", // REQUIRED: Your admin username
      "Password": "", // REQUIRED: Your admin password
      "Email": "admin@castellan.security"
    }
  },

  // AI Configuration
  "LLM": {
    "Provider": "Ollama", // "Ollama" (local, free) or "OpenAI" (requires API key)
    "Model": "llama3.1:8b-instruct-q8_0",
    "Endpoint": "http://localhost:11434",
    "OpenAIModel": "gpt-4o-mini",
    "OpenAIKey": "" // Set OPENAI_API_KEY env var
  },
  "Embeddings": {
    "Provider": "Ollama",
    "Model": "nomic-embed-text",
    "Endpoint": "http://localhost:11434",
    "OpenAIKey": ""
  },

  // Vector Database
  "Qdrant": {
    "UseCloud": false,
    "Host": "localhost",
    "Port": 6333,
    "Https": false,
    "ApiKey": "",
    "Collection": "log_events",
    "VectorSize": 768,
    "Distance": "Cosine"
  },

  // Notifications - Microsoft Teams
  "Notifications": {
    "Teams": {
      "Enabled": false,
      "WebhookUrl": "", // Your Teams webhook URL
      "CastellanUrl": "http://localhost:3000",
      "RateLimitSettings": {
        "CriticalThrottleMinutes": 0, // 0 = no throttle for critical events
        "HighThrottleMinutes": 5,
        "MediumThrottleMinutes": 15,
        "LowThrottleMinutes": 60
      }
    },
    // Slack Notifications
    "Slack": {
      "Enabled": false,
      "WebhookUrl": "", // Your Slack webhook URL
      "CastellanUrl": "http://localhost:3000",
      "DefaultChannel": "#security-alerts",
      "RateLimitSettings": {
        "CriticalThrottleMinutes": 0,
        "HighThrottleMinutes": 5,
        "MediumThrottleMinutes": 15,
        "LowThrottleMinutes": 60
      }
    }
  },

  // Threat Intelligence Services
  "ThreatIntelligence": {
    "VirusTotal": {
      "Enabled": false,
      "ApiKey": "", // Your VirusTotal API key
      "RateLimitPerMinute": 4, // Free tier: 4/min, Premium: higher
      "CacheEnabled": true,
      "CacheTtlMinutes": 60
    },
    "MalwareBazaar": {
      "Enabled": false,
      "RateLimitPerMinute": 10,
      "CacheEnabled": true,
      "CacheTtlMinutes": 60
    },
    "AlienVaultOtx": {
      "Enabled": false,
      "ApiKey": "", // Your AlienVault OTX API key
      "RateLimitPerMinute": 10,
      "CacheEnabled": true,
      "CacheTtlMinutes": 60
    }
  },

  // IP Enrichment (Geolocation)
  "IPEnrichment": {
    "Enabled": true,
    "Provider": "MaxMind", // "MaxMind" or "Disabled"
    "MaxMindCityDbPath": "data/GeoLite2-City.mmdb",
    "MaxMindASNDbPath": "data/GeoLite2-ASN.mmdb",
    "MaxMindCountryDbPath": "data/GeoLite2-Country.mmdb",
    "CacheMinutes": 60,
    "MaxCacheEntries": 10000,
    "HighRiskCountries": ["CN", "RU", "KP", "IR", "SY", "BY"]
  },

  // YARA Malware Detection
  "YaraScanning": {
    "Enabled": true,
    "MaxFileSizeMB": 100,
    "ScanTimeoutSeconds": 30,
    "MaxConcurrentScans": 4,
    "AutoScanSecurityEvents": true
  },

  // MITRE ATT&CK Integration
  "Mitre": {
    "AutoImportOnStartup": true,
    "RefreshIntervalDays": 30
  },

  // Security Event Retention (24-hour rolling window optimized for AI)
  "SecurityEventRetention": {
    "RetentionHours": 24, // 24-hour rolling window for AI pattern detection
    "CleanupIntervalMinutes": 60
  },

  // Windows Event Log Monitoring
  "WindowsEventLog": {
    "Enabled": true,
    "Channels": [
      {
        "Name": "Security",
        "Enabled": true,
        "XPathFilter": "*[System[(EventID=4624 or EventID=4625 or EventID=4672 or EventID=4688)]]",
        "MaxQueue": 5000
      },
      {
        "Name": "Microsoft-Windows-Sysmon/Operational",
        "Enabled": true,
        "MaxQueue": 10000
      }
    ]
  },

  // Startup Configuration
  "Startup": {
    "AutoStart": {
      "Enabled": true,
      "Qdrant": true,
      "ReactAdmin": true,
      "SystemTray": true
    }
  }
}
